<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
<link rel="stylesheet" href="../theme/css/my.css" /><h2>概述</h2>
<p>规则引擎是为一些多变的业务需求提供一种配置而非硬编码的解决方案。</p>
<h2>drools</h2>
<p>参考:
<a href="https://zhuanlan.zhihu.com/p/28528925">小明历险记：规则引擎drools教程一</a>
<a href="https://github.com/ityouknow/drools-examples">drools-examples</a></p>
<p>如：</p>
<pre><code>100元以下, 不加分

100元-500元 加100分

500元-1000元 加500分

1000元 以上 加1000分

</code></pre>
<p>对应的部分规则如下：</p>
<pre><code>import com.neo.drools.entity.Order



rule &quot;zero&quot;

    no-loop true

    lock-on-active true

    salience 1

    when

        $s : Order(amout &lt;= 100)

    then

        $s.setScore(0);

        update($s);

end

</code></pre>
<h2>Esper</h2>
<p>Esper是用于CEP（复杂事件处理）和ESP（事件流处理）应用程序的组件。</p>
<p>参考：
<a href="http://josh-persistence.iteye.com/blog/2032397">Esper入门介绍及热身（一）</a>
<a href="http://josh-persistence.iteye.com/blog/2033466">Esper入门例子（二）</a></p>
<ul>
<li>
<p>Esper典型的应用：</p>
<ul>
<li>
<p>1、 Esper可以用在股票系统、风险监控系统等等要求实时性比较高的系统中。</p>
</li>
<li>
<p>2、业务处理管理和自动化（处理监控，业务活动监控，异常报告，经营智能化等等） </p>
</li>
<li>
<p>3、 财务（算法交易，欺诈检查，风险管理） </p>
</li>
<li>
<p>4、 网络及应用程序监控（入侵检测，SLA(Service Level Agreement)监控） </p>
</li>
<li>5、传感器网络应用（RFID 读取，生产线调度和控制，空中交通） </li>
</ul>
</li>
</ul>
<pre><code>class Apple   { 
    private int id;   

    private int price;    
}
// 监听器
class AppleListener implements UpdateListener {
    public void update(EventBean[] newEvents, EventBean[] oldEvents) {    
        if (newEvents != null) {    
            Double avg = (Double) newEvents[0].get(&quot;avg(price)&quot;);   

            System.out.println(&quot;Apple's average price is &quot; + avg);   

        }

    }
}
//测试类
public class Test {
    public static void main(String[] args) throws InterruptedException {   

        EPServiceProvider epService = EPServiceProviderManager.getDefaultProvider();
        EPAdministrator admin = epService.getEPAdministrator();



        String product = Apple.class.getName();   

        String epl = &quot;select avg(price) from &quot; + product + &quot;.win:length_batch(3)&quot;;   



        EPStatement state = admin.createEPL(epl); 

        state.addListener(new AppleListener());   



        EPRuntime runtime = epService.getEPRuntime();   



        Apple apple1 = new Apple();   

        apple1.setId(1);   

        apple1.setPrice(5);   

        runtime.sendEvent(apple1);   

    }

}
</code></pre>
<h2>easy-rules</h2>
<p><a href="https://github.com/j-easy/easy-rules"> easy-rules github </a>
<a href="https://github.com/jonashackt/spring-easyrules">spring-easyrules sample</a></p>
<pre><code class="language-java">@Rule(name = &quot;weather rule&quot;, description = &quot;if it rains then take an umbrella&quot; )

public class WeatherRule {



    @Condition

    public boolean itRains(@Fact(&quot;rain&quot;) boolean rain) {

        return rain;

    }



    @Action

    public void takeAnUmbrella() {

        System.out.println(&quot;It rains, take an umbrella!&quot;);

    }

}



public class Test {

    public static void main(String[] args) {

        // define facts

        Facts facts = new Facts();

        facts.put(&quot;rain&quot;, true);



        // define rules

        Rule weatherRule = ...

        Rules rules = new Rules();

        rules.register(weatherRule);



        // fire rules on known facts

        RulesEngine rulesEngine = new DefaultRulesEngine();

        rulesEngine.fire(rules, facts);

    }

}

</code></pre>
<h2>其他引擎</h2>
<p><a href="https://github.com/youseries/urule">URULE github</a>
URULE是一款基于RETE算法的纯Java规则引擎，提供规则集、决策表、决策树、评分卡，规则流等各种规则表现工具及基于网页的可视化设计器，可快速开发出各种复杂业务规则。</p>