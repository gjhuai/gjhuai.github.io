<p>[TOC]</p>
<h2>常用操作</h2>
<h3>用户管理</h3>
<ul>
<li>
<p>创建用户</p>
<blockquote>
<p><code>CREATE USER 'username'@'host' IDENTIFIED BY 'password';</code>
host：指定该用户在哪个主机上可以登陆，如果是本地用户可用localhost，如果想让该用户可以从任意远程主机登陆，可以使用通配符%
<code>CREATE USER 'pig'@'%' IDENTIFIED BY '123456';</code></p>
</blockquote>
</li>
<li>
<p>更改用户密码</p>
</li>
</ul>
<pre><code class="language-sql"># 改密码
SET PASSWORD FOR 'username'@'host' = PASSWORD('newpassword');
# 如果是当前登陆用户用:
SET PASSWORD = PASSWORD(&quot;newpassword&quot;);
# 例子:
SET PASSWORD FOR 'pig'@'%' = PASSWORD(&quot;123456&quot;);
</code></pre>
<ul>
<li>授权</li>
</ul>
<pre><code class="language-sql">GRANT SELECT, INSERT ON test.user TO 'pig'@'%';
GRANT ALL ON *.* TO 'pig'@'%';
# 用以上命令授权的用户不能给其它用户授权，如果想让该用户可以授权，用以下命令:
GRANT privileges ON databasename.tablename TO 'username'@'host' WITH GRANT OPTION;
</code></pre>
<ul>
<li>撤销用户权限</li>
</ul>
<pre><code class="language-sql"># 说明:privilege, databasename, tablename：同授权部分,不能超越。
REVOKE privilege ON databasename.tablename FROM 'username'@'host';
# 例子:
REVOKE SELECT ON *.* FROM 'pig'@'%';
</code></pre>
<ul>
<li>删除用户
<code>DROP USER 'username'@'host';</code></li>
</ul>
<h4>用户授权</h4>
<p>命令格式：</p>
<blockquote>
<p><code>mysql&gt; grant 权限1,权限2,…权限n on 数据库名称.表名称 to 用户名@用户地址 identified by '连接口令';</code>
- 权限1,权限2,…权限n代表  <code>select,insert,update,delete,create,drop,index,alter,grant,references,reload,shutdown,process,file</code> 等14个权限。
- 当权限1,权限2,…权限n被 <code>all privileges</code> 或者 <code>all</code> 代替，表示赋予用户全部权限。
- 当 <code>数据库名称.表名</code> 称被 <code>*.*</code> 代替，表示赋予用户操作服务器上所有数据库所有表的权限。
- 用户地址可以是 <code>localhost</code> ，也可以是ip地址、机器名字、域名。也可以用 <code>'%'</code> 表示从任何地址连接。
- <code>'连接口令'</code> 不能为空，否则创建失败。</p>
</blockquote>
<pre><code class="language-shell"># 给来自10.163.225.87的用户joe分配可对数据库vtdc的employee表进行select,insert,update,delete,create,drop等操作的权限，并设定口令为123。
mysql&gt;grant select,insert,update,delete,create,drop on vtdc.employee to joe@10.163.225.87 identified by '123';

# 给来自10.163.225.87的用户joe分配可对数据库vtdc所有表进行所有操作的权限，并设定口令为123。
mysql&gt;grant all privileges on vtdc.* to joe@10.163.225.87 identified by '123';

# 给来自10.163.225.87的用户joe分配可对所有数据库的所有表进行所有操作的权限，并设定口令为123。
mysql&gt;grant all privileges on *.* to joe@10.163.225.87 identified by '123';

# 给本机用户joe分配可对所有数据库的所有表进行所有操作的权限，并设定口令为123。
mysql&gt;grant all privileges on *.* to joe@localhost identified by '123';
</code></pre>
<h3>Database/Table操作</h3>
<ul>
<li>创建数据库</li>
</ul>
<pre><code class="language-mysql">CREATE DATABASE `mydb` CHARACTER SET utf8 COLLATE utf8_general_ci;
show databases;
use wifidb
</code></pre>
<ul>
<li>
<p>MySQL在Linux下的表名如何不区分大小写</p>
<blockquote>
<p>在CentOS7下，在 <code>/etc/my.cnf</code> 文件中 <code>[mysqld]</code> 的后面加 <code>lower_case_table_names=1</code>。  0,区分大小写; 1,不区分。
然后重启mysql： <code>systemctl reload mysqld</code></p>
</blockquote>
</li>
<li>
<p>执行sql文件：</p>
</li>
</ul>
<pre><code class="language-shell">mysql -uuser -p  # 输入密码
use testdb
source /home/gjh/t.sql
</code></pre>
<ul>
<li>查看mysql版本的四种方法</li>
</ul>
<pre><code class="language-shell">[shengting@login ~]$ `mysql -V`
mysql&gt; status;
mysql&gt; `select version();`
</code></pre>
<ul>
<li>查看表字段：</li>
</ul>
<pre><code class="language-sql">desc tableName;
show fields from tableName;
show columns from tableName;
</code></pre>
<h2>运维</h2>
<h3>导入导出</h3>
<ul>
<li>导出</li>
</ul>
<p>导出数据库：<code>mysqldump -u 用户名 -p 数据库名 &gt; 导出的文件名</code>，如我输入的命令行:
<code>mysqldump -u root -p news &gt; news.sql</code>  (输入后会让你输入进入MySQL的密码)
（如果导出单张表的话在数据库名后面输入表名即可）</p>
<ul>
<li>导入</li>
</ul>
<p>1、进入MySQL：<code>mysql -u 用户名 -p</code> ，如我输入的命令行: <code>mysql -u root -p</code> (输入同样后会让你输入MySQL的密码)
2、新建你要建的数据库，这时是空数据库，如新建一个名为news的目标数据库 ： <code>CREATE DATABASE IF NOT EXISTS yourdbname DEFAULT CHARSET utf8 COLLATE utf8_general_ci;</code>
3、输入：<code>mysql&gt;use 目标数据库名</code>，如我输入的命令行: <code>mysql&gt;use news;</code>
4、导入文件：<code>mysql&gt;source 导入的文件名;</code> 如我输入的命令行：<code>mysql&gt;source news.sql;</code></p>
<h2>性能优化</h2>
<h3>36个字节UUID字符串做主键的性能问题</h3>
<p>可以使用 binary(16) not null来存储uuid(中间的-删除哈)
<code>unhex(replace('a3eea910-5cab-11df-bbb5-000c29e30cf0','-','');</code>
检索出来的时候用hex()</p>
<p>这样主键只有原来的一半,效率要高些</p>
<p>MySQL inserting UUID to a binary(16) field
It is advantageous to store a UUID (acc to RFC 4122) in a binary(16) field in the database.
It is not hard to create such a table and to insert data into it.</p>
<pre><code class="language-sql">CREATE TABLE IF NOT EXISTS test_table (
    id BINARY(16) NOT NULL,
    name varchar(128) NOT NULL,
    PRIMARY KEY (id));
INSERT INTO test_table (id, name) VALUES 
    (UNHEX(REPLACE(UUID(),'-','')), 'test1'),
    (UNHEX(REPLACE(UUID(),'-','')), 'test2'),
    (UNHEX(REPLACE(UUID(),'-','')), 'test3')
  );
</code></pre>